1. 题目：函数调用过程（C）

2. 函数相关概念

    + 寄存器
      + `ss:esp`：函数栈帧的栈顶
      + `ss:ebp`：函数栈帧的栈底
      + `cs:eip`：当前指令地址
      + `eax`：存放返回值
    + 函数的本质
      + 栈帧的创建与销毁
    + 参数传递
      + 从右向左依次压栈
    + 返回值处理
      + 调用函数后将返回值保存到`eax`寄存器中
      + 将`eax`寄存器中的值设置到对应的局部变量

3. 函数调用过程
   1. 从右向左压入函数参数
   2. `call`指令：将函数返回地址压栈
   3. `push ebp`：保存当前函数的栈底地址
   4. `mov ebp, esp`：为调用的函数设置新的栈底地址
   5. 保存现场：将用到的所有寄存器压栈
   6. 恢复现场：将栈中的值还原到寄存器中
   7. `pop ebp`：将栈底地址设置为调用者的栈底地址
   8. `ret`：将返回地址弹出到`eip`寄存器中
   9. 恢复栈顶地址

源代码

```c
int add(int n1, int n2)
{
    return n1 + n2;
}

int main(int argc, char *argv[])
{
    int a = 10;
    int b = 20;
    int c = add(a, b);
    return 0;
}
```

汇编代码

```asm
; 0x5655618d
push ebp
mov ebp, esp
push DWORD PTR [ebp - 0x8]
push DWORD PTR [ebp - 0xc]
add eax, edx
pop ebp
ret

; 0x565561b4
push DWORD PTR [ebp - 0x8]
push DWORD PTR [ebp - 0xc]
call 0x5655618d
```